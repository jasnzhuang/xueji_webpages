@{
    var sname = "";
    var snum = "";
    var sid = "";
    if (!IsPost)
    {
        if (!Request.QueryString["ID"].IsEmpty() && Request.QueryString["ID"].IsInt())
        {
            sid = Request.QueryString["ID"];
            var db = Database.Open("startersite");
            var dbCommand = "SELECT * FROM students WHERE sid = @0";
            var row = db.QuerySingle(dbCommand, sid);
            if (row != null)
            {
                sname = row.sname;
                snum = row.snum;
            }
            else
            {
                Validation.AddFormError("没有找到这个ID的学生.");
            }
        }
        else
        {
            Validation.AddFormError("没有找到这个ID的学生.");
        }
    }
    //两个条件：第一，这是一个POST请求，第二，这是由一个叫做buttonDelete的按钮提交的请求
    if (IsPost && !Request["buttonDelete"].IsEmpty())
    {
        sid = Request.Form["sid"];
        var db = Database.Open("startersite");
        var deleteCommand = "DELETE FROM students WHERE sid = @0";
        
        var logg = db.QuerySingle("select * FROM students WHERE sid = "+sid);
        string logit = "sid=" + logg.sid + ",snum=" + logg.snum + ",sname=" + logg.sname + ",ssex=" + logg.ssex + ",sage=" + logg.sage + ",sphone=" + logg.sphone + ",qq=" + logg.qq + ",wx=" + logg.wx + ",sstatus=" + logg.sstatus + ",cid=" + logg.cid;

        var logCommand = "insert into log (who,whichtable,actiontype,withwhat,whendoes)values('1','students','delete',@0,getdate())";
        db.Execute(logCommand, logit);
        db.Execute(deleteCommand, sid);
        Response.Redirect("~/students");
    }
}

<!DOCTYPE html>
<html lang="en">
<head>
    <title>删除学生信息</title>
</head>
<body>
<h1>删除学生信息</h1>
@Html.ValidationSummary()
<p><a href="~/students">返回学生列表</a></p>

<form method="post">
    <fieldset>
        <legend>学生信息</legend>

        <p>
            <span>学生姓名:</span>
            <span>@sname</span>
        </p>

        <p>
            <span>学号:</span>
            <span>@snum</span>
        </p>

        <input type="hidden" name="sid" value="@sid" />
        <p><input type="submit" name="buttonDelete" value="确认删除" /></p>
    </fieldset>
</form>
</body>
</html>